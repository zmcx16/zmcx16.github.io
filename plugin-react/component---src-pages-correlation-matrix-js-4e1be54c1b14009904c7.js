(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"4cdY":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("hszt"),o=a("wcMh"),n=a("J+eN"),l=a("b+jq"),c=a("Ao2N"),i=Object(r.a)({chartName:"LineChart",GraphicalChild:o.a,axisComponents:[{axisType:"xAxis",AxisComp:n.a},{axisType:"yAxis",AxisComp:l.a}],formatAxisMap:c.b})},KR5i:function(e,t,a){e.exports={container:"marketCorrelationMatrix-module--container--1PUvo",matrixColTitle:"marketCorrelationMatrix-module--matrixColTitle--3EqUq",matrixRowTitle:"marketCorrelationMatrix-module--matrixRowTitle--1b_7B",matrixNodeFirstRow:"marketCorrelationMatrix-module--matrixNodeFirstRow--1j9rp",matrixNodeFirstColumn:"marketCorrelationMatrix-module--matrixNodeFirstColumn--afYwl",matrixNode:"marketCorrelationMatrix-module--matrixNode--2FWdd"}},N5Ut:function(e,t,a){"use strict";a.r(t);var r=a("q1tI"),o=a.n(r),n=a("w8ma"),l=a("KQm4"),c=a("V3n9"),i=a("tAME"),s=a("hGmu"),m=a("G43+"),d=a("je4i"),p=a.n(d),u=a("tFdz"),b=a("jJ2d"),h=a("oqdv"),y=a("ps87"),g=a("4cdY"),x=a("y9N3"),w=a("J+eN"),f=a("b+jq"),E=a("nJDY"),S=a("Yjvw"),v=a("wcMh"),N=a("wd/R"),j=a.n(N);var k=e=>{let{data:t,description:a}=e;return o.a.createElement("div",{style:{width:window.innerWidth-100+"px",height:window.innerHeight-100+"px",maxWidth:"1200px",maxHeight:"600px"}},o.a.createElement(y.a,{width:"100%",height:"100%"},o.a.createElement(g.a,{data:t,margin:{top:5,right:30,left:20,bottom:5}},o.a.createElement(x.a,{strokeDasharray:"3 3"}),o.a.createElement(w.a,{dataKey:"Date",tickFormatter:e=>j()(e).format("MM/DD/YYYY")}),o.a.createElement(f.a,{domain:[-1,1]}),o.a.createElement(E.a,null),o.a.createElement(S.a,null),o.a.createElement(v.a,{type:"monotone",name:a,dataKey:"Score",stroke:"#8884d8",dot:!1}))))},M=a("KR5i"),O=a.n(M);const C=(e,t)=>{let a=0,r=0,o=0,n=0,l=0;const c=e.length=t.length=Math.min(e.length,t.length);return e.forEach((e,c)=>{const i=t[c];a+=e,r+=i,o+=e*i,n+=e*e,l+=i*i}),(c*o-a*r)/Math.sqrt((c*n-a*a)*(c*l-r*r))},R=e=>e.map(e=>({symbol:e.symbol,src:e.src})),T=e=>{const t=R(e);return t.reduce((a,r)=>{const o=e.find(e=>e.symbol===r.symbol),n=t.reduce((e,a)=>{const n=o.correlations[a.symbol].value,c=o.correlations[a.symbol].p_value,i=o.dataUrl,s=t.findIndex(e=>e.symbol==r.symbol),m=t.findIndex(e=>e.symbol==a.symbol),d=n<0?(e=>{const t=Math.abs(e);return`rgba(243, 87, 86, ${isNaN(t)?0:t})`})(n):(e=>{const t=Math.abs(e);return`rgba(46, 233, 255, ${isNaN(t)?0:t})`})(n);return[].concat(Object(l.a)(e),[{colSymbolSrc:a,rowSymbolSrc:r,row:s,column:m,value:n,pValue:c,dataUrl:i,color:d}])},[]);return[].concat(Object(l.a)(a),Object(l.a)(n))},[])},D=e=>{let{data:t,popperTipRef:a,modalWindowRef:r}=e,n=O.a.matrixNode;0===t.row&&(n+=" "+O.a.matrixNodeFirstRow),0===t.column&&(n+=" "+O.a.matrixNodeFirstColumn);const l=`${t.colSymbolSrc.symbol} has a ${t.value} correlation to ${t.rowSymbolSrc.symbol}\np-value: ${t.pValue}\n`,c=Object(u.a)({cachePolicy:"no-cache"}),i=Object(u.a)({cachePolicy:"no-cache"});return o.a.createElement("div",{className:n},o.a.createElement("div",{style:{background:t.color},onMouseOver:e=>{a.current.setOpen(!0,e.currentTarget,l)},onMouseOut:()=>{a.current.setOpen(!1)},onClick:()=>{const e=async(e,t,a)=>{let r=btoa(e+"_"+t)+".json";const o=await a.get("/plugin-react/markets/"+r);return a.response.ok&&o.data&&o.data.length>0?o.data:null};Promise.all([e(t.colSymbolSrc.src,t.colSymbolSrc.symbol,c),e(t.rowSymbolSrc.src,t.rowSymbolSrc.symbol,i)]).then(e=>{if(2==e.length&&null!==e[0]&&null!==e[1]){const a=(e,t,a)=>Date.parse(e)-Date.parse(t)>24*a*60*60*1e3,n=e=>{let t={};const r=a(e[0].Date,e[1].Date,15);return e.forEach((e,a)=>{let o=e.Close;if("string"==typeof o&&(o=parseFloat(o.replace("%",""))),r){let a=Date.parse(e.Date);const r=(a.getMonth()+1).toString().padStart(2,"0")+"/01/"+a.getFullYear().toString();t[r]=o}else t[e.Date]=o}),t};let l=n(e[0]),c=n(e[1]);const i=((e,t)=>Object.keys(e).filter({}.hasOwnProperty.bind(t)))(l,c);let s=2,m=Date.parse(i[i.length-1])+24*h.m*60*60*1e3;for(let e=i.length-2;e>=0;e--)if(m<=Date.parse(i[e])){s=Math.max(s,i.length-1-e+1);break}let d=[];for(let e=i.length-1-s+1;e>=0;e--){let t=[],a=[];i.slice(e,e+s).forEach(e=>{t.push(l[e]),a.push(c[e])});let r=C(t,a);d.push({Date:i[e],Score:r})}const p=`${t.rowSymbolSrc.symbol} - ${t.colSymbolSrc.symbol} Rolling ${h.m} days Correlation`;r.current.popModalWindow(o.a.createElement(k,{data:d,description:p}))}else r.current.popModalWindow(o.a.createElement("div",null,"Load some market data failed"))}).catch(()=>{r.current.popModalWindow(o.a.createElement("div",null,"Load market data failed"))})}},"NaN"===t.value?"NaN":t.value.toFixed(2).replace(/(\.0*|(?<=(\..*))0*)$/,"").replace("0.",".")))},F=e=>{let{popperTipRef:t}=e;t.current={setOpen:function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=""),e&&(c(t),p(a)),n(e)},getOpen:()=>a};const{0:a,1:n}=Object(r.useState)(!1),{0:l,1:c}=Object(r.useState)(null),{0:d,1:p}=Object(r.useState)("");return o.a.createElement(i.a,{open:a,anchorEl:l,transition:!0},e=>{let{TransitionProps:t}=e;return o.a.createElement(s.a,Object.assign({},t,{timeout:350}),o.a.createElement(m.a,{style:{padding:"10px"}},o.a.createElement("span",{style:{whiteSpace:"pre-line",lineHeight:"20px",textAlign:"center"}},d)))})};var W=()=>{const e=Object(r.useRef)({popModalWindow:null,popPureModal:null}),t=Object(r.useRef)({setOpen:null,getOpen:null}),{0:a,1:n}=Object(r.useState)([]),{get:l,response:i}=Object(u.a)({cachePolicy:"no-cache"});return Object(r.useEffect)(()=>((async()=>{const t=await l("/plugin-react/market-correlation-matrix.json");i.ok?(console.log(t),n(t.table)):(e.current.popModalWindow(o.a.createElement("div",null,"Load market-correlation-matrix.json failed")),n([]))})(),()=>{}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:O.a.container},o.a.createElement("div",{style:{display:"grid",justifyItems:"center",alignItems:"center",gridTemplateColumns:"200px "+"40px ".repeat(R(a).length)}},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:O.a.matrixColTitle,key:p.a.generate()}),R(a).map(e=>o.a.createElement("div",{className:O.a.matrixColTitle,key:p.a.generate()},e.symbol))),(()=>{let r=[];return T(a).forEach((n,l)=>{l%a.length==0&&r.push(o.a.createElement("div",{className:O.a.matrixRowTitle,key:p.a.generate()},o.a.createElement(c.a,{href:n.dataUrl,target:"_blank",rel:"noreferrer noopener"},o.a.createElement("span",null,n.rowSymbolSrc.symbol)))),r.push(o.a.createElement(D,{data:n,popperTipRef:t,modalWindowRef:e,key:p.a.generate()}))}),r})())),o.a.createElement(F,{popperTipRef:t}),o.a.createElement(b.a,{modalWindowRef:e}))};t.default=()=>o.a.createElement(n.a,{injectFirst:!0},o.a.createElement(W,null))}}]);
//# sourceMappingURL=component---src-pages-correlation-matrix-js-4e1be54c1b14009904c7.js.map