{"version":3,"sources":["webpack:///./node_modules/recharts/es6/chart/LineChart.js","webpack:///./src/components/correlation-matrix/marketCorrelationMatrix.module.scss","webpack:///./src/components/correlation-matrix/rollingCorrelationChart.js","webpack:///./src/components/correlation-matrix/marketCorrelationMatrix.js","webpack:///./src/pages/correlation-matrix.js"],"names":["LineChart","chartName","GraphicalChild","axisComponents","axisType","AxisComp","formatAxisMap","module","exports","RollingCorrelationChart","_ref","data","description","React","createElement","style","width","window","innerWidth","height","innerHeight","maxWidth","maxHeight","ResponsiveContainer","margin","top","right","left","bottom","CartesianGrid","strokeDasharray","XAxis","dataKey","tickFormatter","tickItem","moment","format","YAxis","domain","Tooltip","Legend","Line","type","name","stroke","dot","getTableCategories","table","map","category","symbol","src","table2MatrixData","categories","reduce","acc","rowSymbolSrc","find","d","categoryCorrelations","acc2","colSymbolSrc","correlation","alpha","value","correlations","pValue","dataUrl","row","findIndex","p","column","color","Math","abs","isNaN","positiveColor","concat","_toConsumableArray","MatrixNode","popperTipRef","modalWindowRef","nodeStyle","marketCorrelationMatrixStyle","matrixNode","matrixNodeFirstRow","matrixNodeFirstColumn","message","fetch1","useFetch","cachePolicy","fetch2","className","background","onMouseOver","event","current","setOpen","currentTarget","onMouseOut","onClick","getMarketData","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","fetchObj","fileName","resp_data","wrap","_context","prev","next","btoa","get","sent","response","ok","length","abrupt","stop","_x","_x2","_x3","apply","arguments","Promise","all","then","allResponses","convertDictData","arr","d1","d2","days","key_data_val","key_data_is_monthly_intervals","Date","parse","forEach","i","v","parseFloat","replace","dt","date_offset","getMonth","toString","padStart","getFullYear","dataDict1","dataDict2","keys","o1","o2","Object","filter","hasOwnProperty","bind","slidingWindowSize","startCalcTime","rollingCorrelationWindowDays","max","pcorrData","_loop","dataX","dataY","slice","e","push","x","y","sumX","sumY","sumXY","sumX2","sumY2","minLength","score","min","xi","idx","yi","sqrt","popModalWindow","catch","toFixed","PopperTip","_ref3","a","msg","setAnchorEl","setMessage","setOpenPopper","getOpen","openPopper","_useState","useState","_useState2","anchorEl","_useState3","Popper","open","transition","_ref4","TransitionProps","Fade","assign","timeout","Paper","padding","whiteSpace","lineHeight","textAlign","MarketCorrelationMatrix","output","useRef","popPureModal","_useState4","setTable","_useFetch","getCorrelationTable","_ref5","_callee2","_context2","console","log","useEffect","Fragment","container","display","justifyItems","alignItems","gridTemplateColumns","repeat","matrixColTitle","key","shortid","generate","val","matrixRowTitle","Link","href","target","rel","ModalWindow","CorrelationMatrixPage","StylesProvider","injectFirst"],"mappings":"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","file":"component---src-pages-correlation-matrix-js-c60ed4e4ceca52bd2bfa.js","sourcesContent":["/**\n * @fileOverview Line Chart\n */\nimport { generateCategoricalChart } from './generateCategoricalChart';\nimport { Line } from '../cartesian/Line';\nimport { XAxis } from '../cartesian/XAxis';\nimport { YAxis } from '../cartesian/YAxis';\nimport { formatAxisMap } from '../util/CartesianUtils';\nexport var LineChart = generateCategoricalChart({\n  chartName: 'LineChart',\n  GraphicalChild: Line,\n  axisComponents: [{\n    axisType: 'xAxis',\n    AxisComp: XAxis\n  }, {\n    axisType: 'yAxis',\n    AxisComp: YAxis\n  }],\n  formatAxisMap: formatAxisMap\n});","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"marketCorrelationMatrix-module--container--1PUvo\",\"matrixColTitle\":\"marketCorrelationMatrix-module--matrixColTitle--3EqUq\",\"matrixRowTitle\":\"marketCorrelationMatrix-module--matrixRowTitle--1b_7B\",\"matrixNodeFirstRow\":\"marketCorrelationMatrix-module--matrixNodeFirstRow--1j9rp\",\"matrixNodeFirstColumn\":\"marketCorrelationMatrix-module--matrixNodeFirstColumn--afYwl\",\"matrixNode\":\"marketCorrelationMatrix-module--matrixNode--2FWdd\"};","import React from 'react'\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer\n} from 'recharts'\n\nimport moment from 'moment'\n\nconst RollingCorrelationChart = ({ data, description }) => {\n  return (\n    <div style={{ width: (window.innerWidth - 100) + 'px', height: (window.innerHeight - 100) + 'px', maxWidth: '1200px', maxHeight: '600px' }}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <LineChart\n          data={data}\n          margin={{\n            top: 5,\n            right: 30,\n            left: 20,\n            bottom: 5,\n          }}\n        >\n          <CartesianGrid strokeDasharray=\"3 3\" />\n          <XAxis dataKey=\"Date\" tickFormatter={(tickItem) => {\n            return moment(tickItem).format('MM/DD/YYYY')\n          }} />\n          <YAxis domain={[-1, 1]}/>\n          <Tooltip />\n          <Legend />\n          <Line type=\"monotone\" name={description} dataKey=\"Score\" stroke=\"#8884d8\" dot={false} />\n        </LineChart>\n      </ResponsiveContainer>\n    </div>\n  )\n}\n\n\nexport default RollingCorrelationChart\n","import React, { useState, useRef, useEffect } from 'react'\nimport Link from '@mui/material/Link'\nimport Popper from '@mui/material/Popper'\nimport Fade from '@mui/material/Fade'\nimport Paper from '@mui/material/Paper'\nimport shortid from 'shortid'\nimport useFetch from 'use-http'\n\nimport ModalWindow from '../modalWindow'\nimport { rollingCorrelationWindowDays } from '../../common/def'\nimport RollingCorrelationChart from './rollingCorrelationChart'\n\nimport marketCorrelationMatrixStyle from './marketCorrelationMatrix.module.scss'\n\nconst pcorr = (x, y) => {\n  let sumX = 0,\n    sumY = 0,\n    sumXY = 0,\n    sumX2 = 0,\n    sumY2 = 0;\n  const minLength = x.length = y.length = Math.min(x.length, y.length),\n    reduce = (xi, idx) => {\n      const yi = y[idx];\n      sumX += xi;\n      sumY += yi;\n      sumXY += xi * yi;\n      sumX2 += xi * xi;\n      sumY2 += yi * yi;\n    }\n  x.forEach(reduce)\n  return (minLength * sumXY - sumX * sumY) / Math.sqrt((minLength * sumX2 - sumX * sumX) * (minLength * sumY2 - sumY * sumY))\n}\n\nconst getTableCategories = (table) => {\n  return table.map((category) => {\n    return {\n      symbol: category.symbol,\n      src: category.src\n    }\n  })\n}\n\nconst table2MatrixData = (table) => {\n\n  const categories = getTableCategories(table)\n\n  const negativeColor = (correlation) => {\n    const alpha = Math.abs(correlation)\n    return `rgba(243, 87, 86, ${isNaN(alpha) ? 0 : alpha})`\n  }\n\n  const positiveColor = (correlation) => {\n    const alpha = Math.abs(correlation);\n    return `rgba(46, 233, 255, ${isNaN(alpha) ? 0 : alpha})`\n  }\n\n  \n\n  const parsedData = categories.reduce((acc, rowSymbolSrc) => {\n    const category = table.find((d) => d.symbol === rowSymbolSrc.symbol)\n    const categoryCorrelations = categories.reduce((acc2, colSymbolSrc) => {\n      const value = category.correlations[colSymbolSrc.symbol]['value']\n      const pValue = category.correlations[colSymbolSrc.symbol]['p_value']\n      const dataUrl = category['dataUrl']\n      const row = categories.findIndex(p => p.symbol == rowSymbolSrc.symbol)\n      const column = categories.findIndex(p => p.symbol == colSymbolSrc.symbol)\n      const color =\n        value < 0 ? negativeColor(value) : positiveColor(value)\n\n      return [\n        ...acc2,\n        {\n          colSymbolSrc,\n          rowSymbolSrc,\n          row,\n          column,\n          value,\n          pValue,\n          dataUrl,\n          color\n        }\n      ]\n    }, [])\n    return [...acc, ...categoryCorrelations];\n  }, [])\n\n  return parsedData\n}\n\nconst MatrixNode = ({ data, popperTipRef, modalWindowRef }) => {\n  let nodeStyle = marketCorrelationMatrixStyle.matrixNode\n  if (data.row === 0) {\n    nodeStyle += ' ' + marketCorrelationMatrixStyle.matrixNodeFirstRow\n  }\n\n  if (data.column === 0) {\n    nodeStyle += ' ' + marketCorrelationMatrixStyle.matrixNodeFirstColumn\n  }\n\n  const message = \n`${data.colSymbolSrc.symbol} has a ${data.value} correlation to ${data.rowSymbolSrc.symbol}\np-value: ${data.pValue}\n`\n  const fetch1 = useFetch({ cachePolicy: 'no-cache' })\n  const fetch2 = useFetch({ cachePolicy: 'no-cache' })\n\n  return (\n    <div className={nodeStyle}>\n      <div style={{ background: data.color }} onMouseOver={(event)=>{\n        popperTipRef.current.setOpen(true, event.currentTarget, message)\n      }} onMouseOut={() => {\n        popperTipRef.current.setOpen(false)\n      }} onClick={()=>{\n        const getMarketData = async (src, symbol, fetchObj) => {\n          let fileName = btoa(src + '_' + symbol) + '.json'\n          const resp_data = await fetchObj.get('/plugin-react/markets/' + fileName)\n          if (fetchObj.response.ok && resp_data.data && resp_data.data.length > 0) {\n            return resp_data.data\n          }\n          else {\n            return null\n          }\n        }\n\n        Promise.all([\n          getMarketData(data.colSymbolSrc.src, data.colSymbolSrc.symbol, fetch1),\n          getMarketData(data.rowSymbolSrc.src, data.rowSymbolSrc.symbol, fetch2),\n        ]).then((allResponses) => {\n          // console.log(allResponses)\n          if (allResponses.length == 2 && allResponses[0] !== null && allResponses[1] !== null) {\n            const overDateInterval = (d1, d2, days) => {\n              return Date.parse(d1) - Date.parse(d2) > days * 24 * 60 * 60 * 1000\n            }\n\n            const convertDictData = (arr) => {\n              let key_data_val = {}\n              const key_data_is_monthly_intervals = overDateInterval(arr[0][\"Date\"], arr[1][\"Date\"], 15)\n              arr.forEach((d, i) => {\n                let v = d[\"Close\"]\n                if (typeof v === 'string') {\n                  v = parseFloat(v.replace(\"%\", \"\"))\n                }\n\n                if (key_data_is_monthly_intervals) {\n                  let dt = Date.parse(d[\"Date\"])\n                  const date_offset = (dt.getMonth() + 1).toString().padStart(2, \"0\") + \"/01/\" + dt.getFullYear().toString()\n                  key_data_val[date_offset] = v\n                } else {\n                  key_data_val[d[\"Date\"]] = v\n                }\n              })\n              return key_data_val\n            }\n\n            let dataDict1 = convertDictData(allResponses[0])\n            let dataDict2 = convertDictData(allResponses[1])\n\n            const getIntersectionKey = (o1, o2) => {\n              return Object.keys(o1).filter({}.hasOwnProperty.bind(o2));\n            }\n\n            const keys = getIntersectionKey(dataDict1, dataDict2)\n            let slidingWindowSize = 2\n            let startCalcTime = Date.parse(keys[keys.length - 1]) + rollingCorrelationWindowDays * 24 * 60 * 60 * 1000\n            for (let i = keys.length - 2; i>=0; i--) {\n              if (startCalcTime <= Date.parse(keys[i])) {\n                slidingWindowSize = Math.max(slidingWindowSize, keys.length - 1 - i + 1)\n                break\n              }\n            }\n\n            let pcorrData = []\n            for (let i = keys.length - 1 - slidingWindowSize + 1; i >= 0; i--) {\n              \n              let dataX = []\n              let dataY = []\n              let dataWindow = keys.slice(i, i + slidingWindowSize)\n              dataWindow.forEach((e)=>{\n                dataX.push(dataDict1[e])\n                dataY.push(dataDict2[e])\n              })\n              let score = pcorr(dataX, dataY)\n              pcorrData.push({ 'Date': keys[i], 'Score': score})\n            }\n\n            // console.log(pcorrData)\n            const description = `${data.rowSymbolSrc.symbol} - ${data.colSymbolSrc.symbol} Rolling ${rollingCorrelationWindowDays} days Correlation`\n            modalWindowRef.current.popModalWindow(<RollingCorrelationChart data={pcorrData} description={description} />)\n          } else {\n            modalWindowRef.current.popModalWindow(<div>Load some market data failed</div>)\n          }\n        }).catch(() => {\n          modalWindowRef.current.popModalWindow(<div>Load market data failed</div>)\n        })\n      }}>\n        {data.value === 'NaN' ? 'NaN' : data.value.toFixed(2).replace(/(\\.0*|(?<=(\\..*))0*)$/, '').replace(\"0.\", \".\")}\n      </div>\n    </div>\n  )\n}\n\nconst PopperTip = ({ popperTipRef }) =>{\n\n  // PopperTip API\n  popperTipRef.current = {\n    setOpen: (v, a=null, msg='') => {\n      if (v) {\n        setAnchorEl(a)\n        setMessage(msg)\n      }\n      setOpenPopper(v)\n    },\n    getOpen: () => {\n      return openPopper\n    }\n  }\n\n  const [openPopper, setOpenPopper] = useState(false)\n  const [anchorEl, setAnchorEl] = useState(null)\n  const [message, setMessage] = useState('')\n\n  return (\n    <Popper open={openPopper} anchorEl={anchorEl} transition>\n      {({ TransitionProps }) => (\n        <Fade {...TransitionProps} timeout={350}>\n          <Paper style={{padding: '10px'}}>\n            <span style={{ whiteSpace: 'pre-line', lineHeight: '20px', textAlign: 'center'}}>{message}</span>\n          </Paper>\n        </Fade>\n      )}\n    </Popper>\n  )\n}\n\nconst MarketCorrelationMatrix = () => {\n\n  const modalWindowRef = useRef({\n    popModalWindow: null,\n    popPureModal: null,\n  })\n\n  const popperTipRef = useRef({\n    setOpen: null,\n    getOpen: null,\n  })\n\n  const [table, setTable] = useState([])\n\n  const { get, response } = useFetch({ cachePolicy: 'no-cache' })\n  const getCorrelationTable = async () => {\n    const resp_data = await get('/plugin-react/market-correlation-matrix.json')\n    if (response.ok) {\n      console.log(resp_data)\n      setTable(resp_data['table'])\n    }\n    else {\n      modalWindowRef.current.popModalWindow(<div>Load market-correlation-matrix.json failed</div>)\n      setTable([])\n    }\n  }\n\n  const renderColumnTitle = () => {\n    return (\n      <>\n        <div className={marketCorrelationMatrixStyle.matrixColTitle} key={shortid.generate()}></div>\n        {getTableCategories(table).map((val) => {\n          return <div className={marketCorrelationMatrixStyle.matrixColTitle} key={shortid.generate()}>{val.symbol}</div>\n        })}\n      </>\n    )\n  }\n\n  const renderRowsTitleAndData = () => {\n    let output = []\n    table2MatrixData(table).forEach((d, i)=>{\n      if (i % table.length === 0) {\n        output.push(\n          <div className={marketCorrelationMatrixStyle.matrixRowTitle} key={shortid.generate()}>\n            <Link href={d.dataUrl} target=\"_blank\" rel=\"noreferrer noopener\">\n              <span>{d.rowSymbolSrc.symbol}</span>\n            </Link>\n          </div>)\n      }\n      output.push(<MatrixNode data={d} popperTipRef={popperTipRef} modalWindowRef={modalWindowRef} key={shortid.generate()} />)\n    })\n\n    return output\n  }\n\n  useEffect(() => {\n    // componentDidMount is here!\n    // componentDidUpdate is here!\n    getCorrelationTable()\n    return () => {\n      // componentWillUnmount is here!\n    }\n  }, [])\n\n  return (\n    <>\n      <div className={marketCorrelationMatrixStyle.container}>\n        <div style={{ display: 'grid', justifyItems: 'center', alignItems: 'center', gridTemplateColumns: '200px ' + '40px '.repeat(getTableCategories(table).length)}}>\n          {renderColumnTitle()}\n          {renderRowsTitleAndData()}\n        </div>\n      </div>\n      <PopperTip popperTipRef={popperTipRef}/>\n      <ModalWindow modalWindowRef={modalWindowRef} />\n    </>\n  )\n}\n\nexport default MarketCorrelationMatrix\n","import React from 'react'\nimport { StylesProvider } from '@mui/styles'\n\nimport MarketCorrelationMatrix from '../components/correlation-matrix/marketCorrelationMatrix'\n\nconst CorrelationMatrixPage = () => {\n  return (\n    <StylesProvider injectFirst>\n      <MarketCorrelationMatrix />\n    </StylesProvider>\n  )\n}\n\nexport default CorrelationMatrixPage\n"],"sourceRoot":""}