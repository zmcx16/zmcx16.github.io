(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"4cdY":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("hszt"),l=a("wcMh"),o=a("J+eN"),n=a("b+jq"),c=a("Ao2N"),i=Object(r.a)({chartName:"LineChart",GraphicalChild:l.a,axisComponents:[{axisType:"xAxis",AxisComp:o.a},{axisType:"yAxis",AxisComp:n.a}],formatAxisMap:c.b})},KR5i:function(e,t,a){e.exports={container:"marketCorrelationMatrix-module--container--1PUvo",matrixColTitle:"marketCorrelationMatrix-module--matrixColTitle--3EqUq",matrixRowTitle:"marketCorrelationMatrix-module--matrixRowTitle--1b_7B",matrixNodeFirstRow:"marketCorrelationMatrix-module--matrixNodeFirstRow--1j9rp",matrixNodeFirstColumn:"marketCorrelationMatrix-module--matrixNodeFirstColumn--afYwl",matrixNode:"marketCorrelationMatrix-module--matrixNode--2FWdd"}},N5Ut:function(e,t,a){"use strict";a.r(t);var r=a("q1tI"),l=a.n(r),o=a("w8ma"),n=a("KQm4"),c=a("V3n9"),i=a("tAME"),s=a("hGmu"),m=a("G43+"),d=a("je4i"),p=a.n(d),u=a("tFdz"),b=a("jJ2d"),h=a("oqdv"),y=a("ps87"),g=a("4cdY"),x=a("y9N3"),w=a("J+eN"),f=a("b+jq"),E=a("nJDY"),S=a("Yjvw"),v=a("wcMh"),N=a("wd/R"),j=a.n(N);var k=e=>{let{data:t,description:a}=e;return l.a.createElement("div",{style:{width:window.innerWidth-100+"px",height:window.innerHeight-100+"px",maxWidth:"1200px",maxHeight:"600px"}},l.a.createElement(y.a,{width:"100%",height:"100%"},l.a.createElement(g.a,{data:t,margin:{top:5,right:30,left:20,bottom:5}},l.a.createElement(x.a,{strokeDasharray:"3 3"}),l.a.createElement(w.a,{dataKey:"Date",tickFormatter:e=>j()(e).format("MM/DD/YYYY")}),l.a.createElement(f.a,{domain:[-1,1]}),l.a.createElement(E.a,null),l.a.createElement(S.a,null),l.a.createElement(v.a,{type:"monotone",name:a,dataKey:"Score",stroke:"#8884d8",dot:!1}))))},M=a("KR5i"),O=a.n(M);const C=(e,t)=>{let a=0,r=0,l=0,o=0,n=0;const c=e.length=t.length=Math.min(e.length,t.length);return e.forEach((e,c)=>{const i=t[c];a+=e,r+=i,l+=e*i,o+=e*e,n+=i*i}),(c*l-a*r)/Math.sqrt((c*o-a*a)*(c*n-r*r))},R=e=>e.map(e=>({symbol:e.symbol,src:e.src})),T=e=>{const t=R(e);return t.reduce((a,r)=>{const l=e.find(e=>e.symbol===r.symbol),o=t.reduce((e,a)=>{const o=l.correlations[a.symbol].value,c=l.correlations[a.symbol].p_value,i=l.dataUrl,s=t.findIndex(e=>e.symbol==r.symbol),m=t.findIndex(e=>e.symbol==a.symbol),d=o<0?(e=>{const t=Math.abs(e);return"rgba(243, 87, 86, "+(isNaN(t)?0:t)+")"})(o):(e=>{const t=Math.abs(e);return"rgba(46, 233, 255, "+(isNaN(t)?0:t)+")"})(o);return[].concat(Object(n.a)(e),[{colSymbolSrc:a,rowSymbolSrc:r,row:s,column:m,value:o,pValue:c,dataUrl:i,color:d}])},[]);return[].concat(Object(n.a)(a),Object(n.a)(o))},[])},D=e=>{let{data:t,popperTipRef:a,modalWindowRef:r}=e,o=O.a.matrixNode;0===t.row&&(o+=" "+O.a.matrixNodeFirstRow),0===t.column&&(o+=" "+O.a.matrixNodeFirstColumn);const n=t.colSymbolSrc.symbol+" has a "+t.value+" correlation to "+t.rowSymbolSrc.symbol+"\np-value: "+t.pValue+"\n",c=Object(u.a)({cachePolicy:"no-cache"}),i=Object(u.a)({cachePolicy:"no-cache"});return l.a.createElement("div",{className:o},l.a.createElement("div",{style:{background:t.color},onMouseOver:e=>{a.current.setOpen(!0,e.currentTarget,n)},onMouseOut:()=>{a.current.setOpen(!1)},onClick:()=>{const e=async(e,t,a)=>{let r=btoa(e+"_"+t)+".json";const l=await a.get("/plugin-react/markets/"+r);return a.response.ok&&l.data&&l.data.length>0?l.data:null};Promise.all([e(t.colSymbolSrc.src,t.colSymbolSrc.symbol,c),e(t.rowSymbolSrc.src,t.rowSymbolSrc.symbol,i)]).then(e=>{if(2==e.length&&null!==e[0]&&null!==e[1]){const a=(e,t,a)=>Date.parse(e)-Date.parse(t)>24*a*60*60*1e3,o=e=>{let t={};const r=a(e[0].Date,e[1].Date,15);return e.forEach((e,a)=>{let l=e.Close;if("string"==typeof l&&(l=parseFloat(l.replace("%",""))),r){let a=Date.parse(e.Date);const r=(a.getMonth()+1).toString().padStart(2,"0")+"/01/"+a.getFullYear().toString();t[r]=l}else t[e.Date]=l}),t};let n=o(e[0]),c=o(e[1]);const i=((e,t)=>Object.keys(e).filter({}.hasOwnProperty.bind(t)))(n,c);let s=2,m=Date.parse(i[i.length-1])+24*h.l*60*60*1e3;for(let e=i.length-2;e>=0;e--)if(m<=Date.parse(i[e])){s=Math.max(s,i.length-1-e+1);break}let d=[];for(let e=i.length-1-s+1;e>=0;e--){let t=[],a=[];i.slice(e,e+s).forEach(e=>{t.push(n[e]),a.push(c[e])});let r=C(t,a);d.push({Date:i[e],Score:r})}const p=t.rowSymbolSrc.symbol+" - "+t.colSymbolSrc.symbol+" Rolling "+h.l+" days Correlation";r.current.popModalWindow(l.a.createElement(k,{data:d,description:p}))}else r.current.popModalWindow(l.a.createElement("div",null,"Load some market data failed"))}).catch(()=>{r.current.popModalWindow(l.a.createElement("div",null,"Load market data failed"))})}},"NaN"===t.value?"NaN":t.value.toFixed(2).replace(/(\.0*|(?<=(\..*))0*)$/,"").replace("0.",".")))},F=e=>{let{popperTipRef:t}=e;t.current={setOpen:function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=""),e&&(c(t),p(a)),o(e)},getOpen:()=>a};const{0:a,1:o}=Object(r.useState)(!1),{0:n,1:c}=Object(r.useState)(null),{0:d,1:p}=Object(r.useState)("");return l.a.createElement(i.a,{open:a,anchorEl:n,transition:!0},e=>{let{TransitionProps:t}=e;return l.a.createElement(s.a,Object.assign({},t,{timeout:350}),l.a.createElement(m.a,{style:{padding:"10px"}},l.a.createElement("span",{style:{whiteSpace:"pre-line",lineHeight:"20px",textAlign:"center"}},d)))})};var W=()=>{const e=Object(r.useRef)({popModalWindow:null,popPureModal:null}),t=Object(r.useRef)({setOpen:null,getOpen:null}),{0:a,1:o}=Object(r.useState)([]),{get:n,response:i}=Object(u.a)({cachePolicy:"no-cache"});return Object(r.useEffect)(()=>((async()=>{const t=await n("/plugin-react/market-correlation-matrix.json");i.ok?(console.log(t),o(t.table)):(e.current.popModalWindow(l.a.createElement("div",null,"Load market-correlation-matrix.json failed")),o([]))})(),()=>{}),[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:O.a.container},l.a.createElement("div",{style:{display:"grid",justifyItems:"center",alignItems:"center",gridTemplateColumns:"200px "+"40px ".repeat(R(a).length)}},l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:O.a.matrixColTitle,key:p.a.generate()}),R(a).map(e=>l.a.createElement("div",{className:O.a.matrixColTitle,key:p.a.generate()},e.symbol))),(()=>{let r=[];return T(a).forEach((o,n)=>{n%a.length==0&&r.push(l.a.createElement("div",{className:O.a.matrixRowTitle,key:p.a.generate()},l.a.createElement(c.a,{href:o.dataUrl,target:"_blank",rel:"noreferrer noopener"},l.a.createElement("span",null,o.rowSymbolSrc.symbol)))),r.push(l.a.createElement(D,{data:o,popperTipRef:t,modalWindowRef:e,key:p.a.generate()}))}),r})())),l.a.createElement(F,{popperTipRef:t}),l.a.createElement(b.a,{modalWindowRef:e}))};t.default=()=>l.a.createElement(o.a,{injectFirst:!0},l.a.createElement(W,null))}}]);
//# sourceMappingURL=component---src-pages-correlation-matrix-js-03e0bdedd048cb2b9e20.js.map